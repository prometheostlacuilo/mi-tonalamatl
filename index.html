<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tonalamatl - Engranes del Tiempo</title>
    <style>
        body { font-family: 'Georgia', serif; text-align: center; background: #f4ece1; color: #3d2b1f; padding: 10px; }
        .card { background: #fffdfa; border: 2px dashed #8b4513; padding: 15px; border-radius: 15px; max-width: 500px; margin: 0 auto; overflow: hidden; }
        
        /* Contenedor de los engranes */
        .ruedas-container { position: relative; height: 220px; margin: 20px 0; display: flex; justify-content: center; align-items: center; }
        
        .rueda { border: 2px solid #8b4513; border-radius: 50%; position: absolute; transition: transform 2s cubic-bezier(0.45, 0.05, 0.55, 0.95); display: flex; align-items: center; justify-content: center; background: white; }
        
        /* Engrane de 20 Signos (Grande) */
        .rueda-glifos { width: 280px; height: 280px; right: -80px; z-index: 1; border-style: double; border-width: 4px; }
        
        /* Engrane de 13 Numerales (PequeÃ±o) */
        .rueda-numerales { width: 150px; height: 150px; left: -20px; z-index: 2; border-style: solid; box-shadow: 0 0 10px rgba(0,0,0,0.1); }

        .indicador { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 40px; height: 40px; border: 3px solid #d35400; z-index: 10; border-radius: 5px; pointer-events: none; }

        .tonal-display { font-size: 1.8rem; font-weight: bold; color: #d35400; margin: 10px 0; }
        .info-panel { background: rgba(139, 69, 19, 0.05); padding: 15px; border-radius: 10px; text-align: left; }
        button { background: #8b4513; color: white; border: none; padding: 15px; border-radius: 8px; width: 100%; font-weight: bold; font-size: 1.1rem; }
    </style>
</head>
<body>

<div class="card">
    <h1>CÃ³mputo del Tiempo</h1>
    
    <div id="mecanismo" class="ruedas-container" style="display:none;">
        <div id="r-num" class="rueda rueda-numerales"></div>
        <div id="r-sig" class="rueda rueda-glifos"></div>
        <div class="indicador"></div>
    </div>

    <div id="pantalla">
        <button onclick="iniciarMecanismo()">Calcular DÃ­a de Hoy</button>
    </div>
</div>

<script>
const signos = ["Cipactli", "Ehecatl", "Calli", "Cuetzpalin", "Coatl", "Miquiztli", "Mazatl", "Tochtli", "Atl", "Itzcuintli", "Ozomatli", "Malinalli", "Acatl", "Ocelotl", "Cuauhtli", "Cozcacuauhtli", "Olin", "Tecpatl", "Quiahuitl", "Xochitl"];
const iconos = ["ğŸŠ", "ğŸŒ¬ï¸", "ğŸ ", "ğŸ¦", "ğŸ", "ğŸ’€", "ğŸ¦Œ", "ğŸ‡", "ğŸ’§", "ğŸ•", "ğŸ’", "ğŸŒ¿", "ğŸ¹", "ğŸ†", "ğŸ¦…", "ğŸ¦‰", "ğŸŒ€", "ğŸ”ª", "ğŸŒ§ï¸", "ğŸŒ¸"];

function iniciarMecanismo() {
    document.getElementById('mecanismo').style.display = 'flex';
    
    const hoy = new Date();
    const fechaRef = new Date('1521-08-23T00:00:00Z'); 
    const difDias = Math.floor((hoy - fechaRef) / (1000 * 60 * 60 * 24));

    // CÃ¡lculos
    let numTonal = ((difDias + 0) % 13) + 1; 
    let signoIdx = (difDias + 4) % 20;
    if (signoIdx < 0) signoIdx += 20;

    // Rotaciones: multiplicamos el Ã­ndice por los grados de cada diente
    let rotNum = - (numTonal - 1) * (360 / 13);
    let rotSig = - (signoIdx) * (360 / 20);

    // Aplicar giro
    document.getElementById('r-num').style.transform = `rotate(${rotNum}deg)`;
    document.getElementById('r-sig').style.transform = `rotate(${rotSig}deg)`;

    // Mostrar resultado despuÃ©s de la animaciÃ³n
    setTimeout(() => {
        mostrarResultado(numTonal, signos[signoIdx], signoIdx, hoy);
    }, 2100);
}

function mostrarResultado(num, nombre, idx, hoy) {
    const aÃ±osSignos = ["Tochtli", "Acatl", "Tecpatl", "Calli"];
    let aÃ±oActual = hoy.getFullYear();
    let numAÃ±o = ((aÃ±oActual - 2026) % 13) + 1; 
    if (numAÃ±o <= 0) numAÃ±o += 13;
    let signoAÃ±o = aÃ±osSignos[(aÃ±oActual - 2026) % 4];

    document.getElementById('pantalla').innerHTML = `
        <div class="tonal-display">${iconos[idx]} ${num} ${nombre}</div>
        <div class="info-panel">
            <p><strong>AÃ±o:</strong> ${numAÃ±o} ${signoAÃ±o}</p>
            <p><strong>Estado del tiempo:</strong> Los engranes se han alineado.</p>
        </div>
        <br>
        <button onclick="location.reload()">Reiniciar Cuenta</button>
    `;
}
</script>
</body>
</html>
